{% extends 'base.html' %}
{% block title %}Alertas – Documentos Vencendo{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Alertas – Documentos Vencendo</h1>
</div>

{% if docs %}
<div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle me-2"></i>
    <strong>{{ docs|length }} documento(s)</strong> vencendo nos próximos 30 dias ou já vencidos.
</div>
{% endif %}

<div class="card p-4">
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Funcionário</th>
                    <th>Tipo</th>
                    <th>Arquivo</th>
                    <th>Vencimento</th>
                    <th>Ação</th>
                </tr>
            </thead>
            <tbody>
                {% for doc in docs %}
                {% set vencido = doc.data_vencimento < hoje %}
                <tr>
                    <td class="fw-bold">{{ doc.funcionario.nome }}</td>
                    <td><span class="badge bg-secondary">{{ doc.tipo }}</span></td>
                    <td class="small">{{ doc.nome_arquivo }}</td>
                    <td>
                        <span class="badge {{ 'bg-danger' if vencido else 'bg-warning text-dark' }}">
                            {{ doc.data_vencimento.strftime('%d/%m/%Y') }}
                            {{ '(VENCIDO)' if vencido else '' }}
                        </span>
                    </td>
                    <td>
                        <a href="{{ url_for('prontuario.prontuario', func_id=doc.funcionario_id) }}"
                           class="btn btn-outline-light btn-sm">Ver Prontuário</a>
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="5" class="text-center text-muted py-4">Nenhum alerta no momento.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
